
// Habilidade da Ruptura
// Só pode ser usado em mapas de guerra do emperium.
// Permite teleportar todos os membros do clã para um castelo inimigo aleatório na área do emperium.";
// Só irá funcionar se o seu cargo no clã for igual ou superior a quinta colocação.
// Jogadores com o Cargo [10] não serão puxados, podendo assim defender o castelo que estiverem.";
// Tempo de Recarga: 30 minutos.

-	Script	Ruptura do RagnaGhostz	45,{

	.@n$ = "[Gerente do Portal]";
	
	mes .@n$;
	
	if( !.ds_open )
	{
		mes "Parece que a ruptura está fechada.";
		
		if( select( "O que é a Ruptura?", "Horários de Ruptura", "Forçar Ruptura" ) )
		{
			case 1:
				mes "A Ruptura é um evento que ocorre sempre em horários fixos.";
				next;
				mes .@n$;
				mes "A Área da Ruptura é uma terra sem lei, onde todos os monstros do servidor se juntam para tentar acabar com a humanidade!";
				next;
				mes .@n$;
				mes "Hordas dos monstros serão invocados de tempo em tempos. Ao morrer lá, você será teleportado de volta para cá e terá que esperar eu autorizar a entrada novamente.";
				next;
				mes .@n$;
				mes "E isso não é tudo, no fim de todas as hordas o PvP é ligado durante 45 segundos até a próxima horda!";
				next;
				mes .@n$;
				mes "No fim do evento 5 baús nascem que podem dar um dos seguintes prêmios a quem der o último dano:"
				mes "[50% de Chance] -> 1 a 1500 pontos de Cash.";
				mes "[30% de Chance] -> 1 a 300 pontos de Evento."; 
				mes "[20% de Chance] -> 20 pontos em uma maestria de classe aleatória (não ultrapassando o nível máximo).";
				mes "[7% de Chance] -> +1% de dano (Máximo 15).";
				mes "[3% de chance] -> Recebe o item [Ruptura de Emperium].";
				next;
				mes .@n$;
				mes "Existem também duas premiações extras para quem matar mais jogadores ou monstros durante o evento.";
				next;
				mes .@n$;
				mes "Aquele que matar mais jogadores, recebe 500 pontos no ranking PvP.";
				mes "Quando morrer, você perde seus pontos!";
				mes "Quando deslogar, você perde seus pontos!";
				next;
				mes "Aquele que matar mais monstros, recebe +300% de dano contra os baús.";
				mes "Quando morrer, você não perde seus pontos";
				mes "Quando deslogar, você perde seus pontos!";
				close;
				
			case 2:
				mes .@n$;
				mes "A Ruptura abre sempre ao 12:00 e às 22:00.";
				close;
				
			case 3:
				next;
				mes .@n$;
				mes "É possível forçar a abertura da ruptura pagando 5000 pontos de cash.";
				mes "Seus pontos atuais: " + #CASHPOINTS;
				
				if( select( "Ok","Forçar Ruptura" ) == 2 )
				{
					if( .ds_open > 0 )
					{
						next;
						mes .@n$;
						mes "Uma Ruptura já está aberta no momento. Tentou ser engraçado?";
						close;
					}
					
					if( #CASHPOINTS < 5000 )
					{
						next;
						mes .@n$;
						mes "Desculpa, mas você não possui a quantidade de Cash necessária para forçar uma ruptura.";
						close;
					}

					#CASHPOINTS -= 5000;
					.forced = 1;
					end;
				}
		}
	}
	
	if( .ds_open == 2 )
	{
		mes "Aguarde um pouco, ainda está perigoso lá dentro. Irei avisar assim que estiver seguro a entrada.";
		close;
	}
	
	if( BaseLevel < 300 )
	{
		mes "Desculpa, mas você ainda não tem nível para enfrentar os monstros de lá.";
		close;
	}
	
	OnInit:
		.ds_open = 0;
		.map$ = "";
		.forced = 0;
		
		// Primeiro Round: Todos os Monstros da Torre Bronze
		// Segundo Round: Todos os Monstros da Torre Prata
		// Terceiro Round: Todos os Monstros da Torre Ouro
		// Quarto Round: Todos os Monstros da Torre Platina
		// Quinto Round: Todos os Monstros da Torre Diamante
		// Sexto Round: Todos os Monstros das Instâncias da Torre Diamante * rand( 5, 20 )
		// Sétimo Round: Todos os monstros da Torre Diamante + Monstros da Instâncias * rand( 1, 5 )
		// Oitavo Round: 500 Plantas
		// Nono Round: Todos os MVPs do Pesadelo e atacar faz com que receba 5% do dano de volta.
		// Decimo Round: Todos os MVP do biolab 3 e atacar faz com que receba 10% do dano de volta.
		.randmin[1] = 5;
		.randmax[1] = 7;
		
		.round$ [2] = "";
		.randmin[2] = 5;
		.randmax[2] = 7;
		end;
		
	L_ForceStart:
		.@forced = 1;
	OnHour1200:
	OnHour2200:
	OnRupturaStart:
		if( .forced && !.@forced ) end;
		
		.ds_open = 1;
		
		if( !.@forced )
		{
			announce "[Ruptura do RagnaGhostz]: A Ruptura do RagnaGhostz foi aberta! 3 minutos para começar o primeiro round!",0;
			
			bot_announce( "A **Ruptura do RagnaGhostz** acaba de abrir!", strcharinfo(0) ), CHANNEL_REALGERAL );
			bot_announce( "3 minutos para iniciar o primeiro round!", strcharinfo(0) ), CHANNEL_REALGERAL );
		}
		else
		{
			bot_announce( sprintf( "**%s** acaba de forçar a abertura da ruptura!", strcharinfo(0) ), CHANNEL_REALGERAL );
			announce "[Ruptura do RagnaGhostz]: " + sprintf( "%s acaba de forçar a abertura da ruptura!", strcharinfo(0) ),0;
			sleep 8000;
			announce "[Ruptura do RagnaGhostz]: A Ruptura do RagnaGhostz foi aberta! 3 minutos para começar o primeiro round!",0;
		}
		end;
		
	OnDSMOBKill:
		if( strcharinfo(3) != .map$ ) end;
		
	OnPcDieEvent:
		if( strcharinfo(3) != .map$ ) end;
		@ds_pvp_points = 0;
		end;
}

/*
ROUND 1:

INSERT INTO `ruptura_mobs` ( `mob_id`, `round` )
	 VALUES ( 1002, 1 ),
            ( 1007, 1 ),
            ( 1008, 1 ),
            ( 1002, 1 ),
            ( 1063, 1 ),
            ( 1002, 1 ),
            ( 1010, 1 ),
            ( 1011, 1 ),
            ( 1011, 1 ),
            ( 1063, 1 ),
            ( 1002, 1 ),
            ( 1014, 1 ),
            ( 1010, 1 ),
            ( 1011, 1 ),
            ( 1107, 1 ),
            ( 1011, 1 ),
            ( 1063, 1 );
			
ROUND 2:


INSERT INTO `ruptura_mobs` ( `mob_id`, `round` )
VALUES ( 1052, 2 ), 
       ( 1841, 2 ), 
       ( 1238, 2 ), 
       ( 1860, 2 ), 
       ( 1811, 2 ), 
       ( 1014, 2 ), 
       ( 1238, 2 ), 
       ( 1239, 2 ), 
       ( 1234, 2 ), 
       ( 1018, 2 ), 
       ( 1055, 2 ), 
       ( 1235, 2 ), 
       ( 1235, 2 ), 
       ( 1005, 2 ), 
       ( 1019, 2 ), 
       ( 1856, 2 ), 
       ( 1076, 2 ), 
       ( 1031, 2 ), 
       ( 1031, 2 ), 
       ( 1128, 2 ), 
       ( 2840, 2 ), 
       ( 1015, 2 ), 
       ( 1579, 2 ), 
       ( 1265, 2 ), 
       ( 1741, 2 ), 
       ( 1965, 2 ), 
       ( 1743, 2 ), 
       ( 1034, 2 ), 
       ( 1014, 2 ), 
       ( 1250, 2 ), 
       ( 1250, 2 ), 
       ( 1686, 2 ), 
       ( 1023, 2 ), 
       ( 1169, 2 ), 
       ( 1452, 2 ), 
       ( 1391, 2 ), 
       ( 1013, 2 ), 
       ( 1100, 2 ), 
       ( 1968, 2 ), 
       ( 1519, 2 ), 
       ( 1074, 2 ), 
       ( 1729, 2 ), 
       ( 1729, 2 ), 
       ( 1016, 2 ), 
       ( 1420, 2 ), 
       ( 1463, 2 ), 
       ( 1593, 2 ), 
       ( 1032, 2 ), 
       ( 1116, 2 ), 
       ( 1116, 2 ), 
       ( 1593, 2 ), 
       ( 1191, 2 ), 
       ( 1271, 2 ), 
       ( 1119, 2 ), 
       ( 1026, 2 ), 
       ( 1026, 2 ), 
       ( 1611, 2 ), 
       ( 1118, 2 ), 
       ( 1108, 2 ), 
       ( 1451, 2 ), 
       ( 1002, 2 );

Round 3:

INSERT INTO `ruptura_mobs` ( `mob_id`, `round` )
VALUES ( 1052, 3 ),
       ( 1841, 3 ),
       ( 1238, 3 ),
       ( 1860, 3 ),
       ( 1811, 3 ),
       ( 1014, 3 ),
       ( 1238, 3 ),
       ( 1239, 3 ),
       ( 1234, 3 ),
       ( 1018, 3 ),
       ( 1055, 3 ),
       ( 1235, 3 ),
       ( 1235, 3 ),
       ( 1005, 3 ),
       ( 1019, 3 ),
       ( 1856, 3 ),
       ( 1076, 3 ),
       ( 1031, 3 ),
       ( 1031, 3 ),
       ( 1128, 3 ),
       ( 2840, 3 ),
       ( 1015, 3 ),
       ( 1579, 3 ),
       ( 1265, 3 ),
       ( 1741, 3 ),
       ( 1965, 3 ),
       ( 1743, 3 ),
       ( 1034, 3 ),
       ( 1014, 3 ),
       ( 1250, 3 ),
       ( 1250, 3 ),
       ( 1686, 3 ),
       ( 1023, 3 ),
       ( 1169, 3 ),
       ( 1452, 3 ),
       ( 1391, 3 ),
       ( 1013, 3 ),
       ( 1100, 3 ),
       ( 1968, 3 ),
       ( 1519, 3 ),
       ( 1074, 3 ),
       ( 1729, 3 ),
       ( 1729, 3 ),
       ( 1016, 3 ),
       ( 1420, 3 ),
       ( 1463, 3 ),
       ( 1593, 3 ),
       ( 1032, 3 ),
       ( 1116, 3 ),
       ( 1116, 3 ),
       ( 1593, 3 ),
       ( 1191, 3 ),
       ( 1271, 3 ),
       ( 1119, 3 ),
       ( 1026, 3 ),
       ( 1026, 3 ),
       ( 1611, 3 ),
       ( 1118, 3 ),
       ( 1108, 3 ),
       ( 1451, 3 ),
       ( 1002, 3 );


*/

